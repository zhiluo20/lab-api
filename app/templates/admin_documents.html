<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Admin | Documents</title>
    <style>
        body { font-family: sans-serif; margin: 2rem auto; max-width: 90rem; }
        header { display:flex; justify-content: space-between; align-items: center; }
        nav a { margin-left:0.5rem; text-decoration:none; padding:0.4rem 0.7rem; border-radius:0.3rem; background:#0b5; color:#fff; }
        table { width:100%; border-collapse:collapse; margin-top:1rem; }
        th, td { border:1px solid #ccc; padding:0.5rem; text-align:left; }
        th { background:#f5f5f5; }
        form.search { margin-top:1rem; display:flex; gap:0.5rem; }
        form.search input[type=text] { flex:1; padding:0.4rem; }
        button { padding:0.4rem 0.8rem; }
        .meta { font-size:0.85rem; color:#444; }
    </style>
</head>
<body>
    <header>
        <div>
            <h1>Document Administration</h1>
            <p>Search, inspect, and manage document lifecycle.</p>
        </div>
        <nav>
            <a href="{{ url_for('admin.admin_index', token=token) }}">Dashboard</a>
            <a href="{{ url_for('admin.list_users', token=token) }}">Users</a>
            <a href="{{ url_for('admin.list_roles', token=token) }}">Roles</a>
            <a href="{{ url_for('web.docs_list', token=token) }}">Return to docs</a>
        </nav>
    </header>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flash {{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form class="search" method="get">
        <input type="hidden" name="token" value="{{ token }}" />
        <input type="text" name="search" value="{{ search }}" placeholder="Search by name or description" />
        <button type="submit">Search</button>
    </form>

    <table>
        <thead>
            <tr>
                <th>Document</th>
                <th>Description</th>
                <th>Owner</th>
                <th>Updated</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for doc in documents.items %}
                <tr>
                    <td>{{ doc.name }}</td>
                    <td>{{ doc.description or '—' }}</td>
                    <td>{{ doc.owner.username if doc.owner else '—' }}</td>
                    <td class="meta">{{ doc.updated_at.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td><a href="{{ url_for('admin.document_detail', doc_id=doc.id, token=token) }}">Inspect</a></td>
                </tr>
            {% endfor %}
            {% if not documents.items %}
                <tr><td colspan="5">No documents found.</td></tr>
            {% endif %}
        </tbody>
    </table>
</body>
</html>
